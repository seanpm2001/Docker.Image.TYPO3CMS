/*!
 * Bootstrap Package v8.1.0 (http://www.bk2k.info)
 * Copyright 2014-2017 Benjamin Kott
 * Licensed under the MIT license
 */

"use strict";!function(){function e(e){var t=e.getSelection(),n=t&&t.getRanges()[0];if(n){for(var r=t.createBookmarks(!1)[0],o=r.startNode,l=r.endNode||o,i=n.createIterator(),u=e.editable(),g=null,c=[];g=i.getNextParagraph();)c.push(g);e.getCommand("bootstrappackage_box").state==CKEDITOR.TRISTATE_OFF?a(e,c):s(e,c),u.contains(o)&&u.contains(l)&&t.selectBookmarks([r]),e.focus()}}function t(e,t){var n=e.document.createElement("div"),r=null;for(n.addClass("well"),n.insertBefore(t[0]);t.length>0;)r=t.shift(),n.append(r)}function n(e){for(var t=e[0].getParent(),n=null,r=0;r<e.length;r++)n=e[r],t=t.getCommonAncestor(n.getParent());for(var o={table:1,tbody:1,tr:1,ol:1,ul:1};o[t.getName()];)t=t.getParent();return t}function r(e,t){for(var n=null,r=null,o=[];t.length>0;){for(r=t.shift();!r.getParent().equals(e);)r=r.getParent();r.equals(n)||(o.push(r),n=r)}return o}function o(e,t){for(var n=null,r=[];t.length>0;)if("div"==(n=t.shift()).getName()){for(var o=new CKEDITOR.dom.documentFragment(e.document);n.getFirst();)o.append(n.getFirst().remove()),r.push(o.getLast());o.replace(n)}else r.push(n);return r}function a(e,a){t(e,o(e,r(n(a),a)))}function l(e){for(var t={},n=[],r=[],o=null,a=null,l=0;l<e.length;l++){var a=null,s=null;if("div"==(o=e[l]).getName()&&u(o))n.push(o);else{for(;o.getParent();){if("div"==o.getParent().getName()){a=o.getParent(),s=o;break}o=o.getParent()}a&&s&&!s.getCustomData("move")&&(r.push(s),CKEDITOR.dom.element.setMarker(t,s,"move",!0))}}for(CKEDITOR.dom.element.clearAllMarkers(t);r.length>0;)a=(o=r.shift()).getParent(),o.getPrevious()?o.getNext()?(o.breakParent(o.getParent()),n.push(o.getNext())):o.remove().insertAfter(a):o.remove().insertBefore(a),a.getCustomData("processed")||(n.push(a),CKEDITOR.dom.element.setMarker(t,a,"processed",!0));return CKEDITOR.dom.element.clearAllMarkers(t),n}function s(e,t){g(l(t))}function i(e,t){var n=t.block||t.blockLimit;this.setState(e.elementPath(n).contains("div",1)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function u(e){for(var t,n=0,r=e.getChildCount();n<r&&(t=e.getChild(n));n++)if(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())return!1;return!0}function g(e){for(var t=null,n=e.length-1;n>=0;n--)u(t=e[n])&&t.remove()}CKEDITOR.plugins.add("bootstrappackage_box",{lang:"en,de",icons:"box",hidpi:!0,init:function(t){t.blockless||(t.addCommand("bootstrappackage_box",{exec:e,refresh:i,context:"div",allowedContent:"div",requiredContent:"div"}),t.ui.addButton&&t.ui.addButton("Box",{label:t.lang.bootstrappackage_box.toolbar,command:"bootstrappackage_box",toolbar:"blocks"}))}})}();